# MySQL日志

| 序号 | 问题              | 一句话解释                                                   |
| ---- | ----------------- | ------------------------------------------------------------ |
| 0    | MySQL的架构分层   | 客户端;<br>连接器、缓存层、分析器、优化器、执行器;<br>存储引擎层 |
| 1    | MySQL的日志有哪些 | **常用**: 重做日志（redo log）、回滚日志（undo log）、二进制日志（binlog） <br>**不常用**: 错误日志（errorlog）、慢查询日志（slow query log）、一般查询日志（general log），中继日志（relay log） |
| 2    | 如何异常恢复      | 只要binlog和redo log能持久化到磁盘，就不怕数据丢失，重启就能恢复。<br>其中，binlog是负责普通数据<br>redo log负责保证事务数据的一致性 |





## MySQL日志的对比

| 日志| 别名 | 作用| 内容    | 存储 | 适用场景 |
| -------- | ---------- | :--------------------------------------------- | ------------------------------------------------------------ | ---- | ------------------------------------ |
| binlog   | 二进制日志 | 记录了所有数据的**变更**          | 简单理解就是sql本身，读sql不记录<br>  | **逻辑格式** | 主从复制、数据恢复(某一刻)、集群同步 |
| redo log | 重做日志   | 确保事务的**持久性**                    | 记录的是物理数据页面的修改的信息，不管事务是否提交都会记录下来 | **物理格式** | 事务的崩溃恢复                       |
| undo log | 回滚日志   | 保证事务的**原子性**<br>提供多版本并发控制下的读（MVCC），也即非锁定读 | 除了记录版本，**还记录着sql的回滚sql**，比如1条insert,也会同时有1条delete | **逻辑格式** | 事务回滚                             |

> 物理日志: 记录的是磁盘一整页的数据
>
> 逻辑日志: client使用的日志，结构已经SQL化了
